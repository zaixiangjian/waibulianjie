@import "str-to-list";
@import "svg-icon-mixins";

// External Links

$internal-list: str-to-list("#{$internal_domains}", "|");
$excluded-list: str-to-list("#{$excluded_domains}", "|");

// EXTERNAL SELECTOR
// Exclude internal/CDN domains AND excluded domains
$external-selector: "a[href*='//']:not([href^='/'])";
@each $domain in $internal-list {
  $d: str-slice($domain, 1);
  @if $d != "" { $external-selector: #{$external-selector} + ":not([href*='#{$d}'])"; }
}
@each $domain in $excluded-list {
  $d: str-slice($domain, 1);
  @if $d != "" { $external-selector: #{$external-selector} + ":not([href*='#{$d}'])"; }
}

// TRUSTED SELECTOR
// Targets only the domains specifically listed in settings
$trusted-selector: "";
@each $link in $excluded-list {
  $trimmed: str-slice($link, 1);
  @if $trimmed != "" {
    @if $trusted-selector != "" { $trusted-selector: $trusted-selector + ", "; }
    $trusted-selector: $trusted-selector + "a[href*='#{$trimmed}']";
  }
}

.topic-body .cooked {
  // Unknown external links
  #{$external-selector} {
    &:before {
      content: "";
      display: inline-block;
      margin-right: 0.25em;
      vertical-align: text-top;
      @include svg-icon(solid, arrow-up-right-from-square, currentColor, 1em, 1em);
    }
  }

  // Trusted external links
  @if $trusted-selector != "" {
    #{$trusted-selector} {
      &:before {
        content: "";
        display: inline-block;
        margin-right: 0.25em;
        vertical-align: text-top;
        @include svg-icon(solid, lock, var(--success), 1em, 1em);
      }
    }
  }
}

// Confirmation Modal

.external-link-modal {
  &__disclaimer {
    margin-top: 0;
  }
  &__confirmation {
    &-title,
    &-subtitle {
      display: block;
    }
    &-title {
      font-weight: 600;
      margin-bottom: 0.25em;
    }
  }
  &__url {
    overflow-wrap: anywhere;
  }
  &__report-hint {
    margin-top: 0.5em;
    font-size: var(--font-down-2);
    color: var(--primary-high);
  }
}
